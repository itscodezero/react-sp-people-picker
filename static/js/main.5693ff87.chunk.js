(this["webpackJsonpreact-sp-people-picker-example"]=this["webpackJsonpreact-sp-people-picker-example"]||[]).push([[0],[,,function(e,t,n){e.exports=n(11)},function(e,t,n){},,,,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(3);var r=n(0),a=n.n(r),o=n(1),i=n.n(o);"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var l=function(e){try{if(!c)return Promise.resolve("This people picker works only in SharePoint context");var t=c+s;return Promise.resolve(function(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}((function(){return Promise.resolve(function(e,t){try{var n=window._spPageContextInfo.siteServerRelativeUrl;return Promise.resolve(getFormDigest(n).then((function(n){return fetch(e,{method:"post",headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose","X-RequestDigest":n.d.GetContextWebInformation.FormDigestValue},credentials:"include",body:JSON.stringify(t)}).then((function(e){return e.json().then((function(e){var t=[];return e.d.ClientPeoplePickerSearchUser&&(t=e),t}))}))})))}catch(r){return Promise.reject(r)}}(t,e))}),(function(e){throw console.log(e),e})))}catch(n){return Promise.reject(n)}},c=window._spPageContextInfo?window._spPageContextInfo.siteAbsoluteUrl:null,s="/_api/SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser",u="_10brd",m="_2QNZO",p="_2z2Tk",f={queryParams:{QueryString:"",MaximumEntitySuggestions:10,AllowEmailAddresses:!0,AllowOnlyEmailAddresses:!1,PrincipalSource:2,PrincipalType:1,SharePointGroupID:0}},y=function(e){return a.a.createElement("ul",{className:m},e.filteredSuggestions.map((function(t,n){return a.a.createElement("li",{key:t.EntityData.Email+"-"+n,onClick:function(n){!function(t){e.handleParentClick(t)}(t)}},""+t.DisplayText,a.a.createElement("p",null,""+t.EntityData.Email))})))},d=function(e){var t=Object(r.useState)(""),n=t[0],o=t[1],i=Object(r.useState)([]),c=i[0],s=i[1],m=Object(r.useState)([]),d=m[0],S=m[1],g=Object(r.useState)(""),h=g[0],P=g[1];return a.a.createElement(r.Fragment,null,a.a.createElement("div",{className:p},a.a.createElement("input",{type:"text",placeholder:"Start typing name or email address..",onChange:function(t){var n=Object.assign({},f);n.queryParams.QueryString=t.currentTarget.value,l(n).then((function(e){if(e&&e.d.ClientPeoplePickerSearchUser&&e.d.ClientPeoplePickerSearchUser.length>0){var t=JSON.parse(e.d.ClientPeoplePickerSearchUser);t=t.map((function(e){if(e.EntityData.Email)return e;var t=e.Key.split("|");return e.EntityData.Email=t[2],e})),o(""),s(t),S(!0)}})).catch((function(e){console.log(e)})),P(t.currentTarget.value),e.onSelect(null)},onKeyDown:function(t){if(13===t.keyCode)o(0),S(!1),P(c[n].DisplayText),e.onSelect(c[n]);else if(38===t.keyCode){if(0===n)return;o(""===n?0:n-1)}else if(40===t.keyCode){if(n===c.length-1)return;o(""===n?0:n+1)}},value:h}),d&&h?c.length>0?a.a.createElement(y,{activeSuggestion:n,filteredSuggestions:c,handleParentClick:function(t){o(0),s([]),S(!1),P(t.DisplayText),e.onSelect(t)}}):h.length>3?a.a.createElement("div",{className:u},a.a.createElement("em",null,"No maching user found!")):a.a.createElement(r.Fragment,null):a.a.createElement(r.Fragment,null)))},S=(n(10),function(){return a.a.createElement(d,{onSelect:function(e){console.log(e)}})});i.a.render(a.a.createElement(S,null),document.getElementById("root"))}],[[2,1,2]]]);
//# sourceMappingURL=main.5693ff87.chunk.js.map